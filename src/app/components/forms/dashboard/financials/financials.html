<form gj-form="formModel" name="financialsForm">

    <div oc-lazy-load="{ files: [ '/app/modules/upload.js' ] }">

	<form-group name="country">

		<p class="help-block" ng-if="!account">
			<span class="jolticon jolticon-notice"></span>
			<strong>Note!</strong> You can't change the country for your account once it's set.
		</p>

		<select form-control="select" ng-if="!account">
			<option ng-repeat="(code, country) in countries track by code" ng-value="code">{{ country }}</option>
		</select>

		<div class="form-static" ng-if="account">
			{{ account.country_code }}
		</div>

		<control-errors></control-errors>
	</form-group>

	<form-group name="type" label="Business Type">
		<div ng-if="!account">
			<div class="radio">
				<label>
					<input form-control="radio" value="individual">
					Individual <br>
					<span class="help-inline">HELP!</span>
				</label>
			</div>
			<div class="radio">
				<label>
					<input form-control="radio" value="company">
					Company <br>
					<span class="help-inline">HELP!</span>
				</label>
			</div>
			<control-errors></control-errors>
		</div>
		<div class="form-static" ng-if="account">
			{{ account.type | uppercase }}
		</div>
	</form-group>

	<fieldset ng-if="account">
		<legend>Your Details</legend>

		<!--<pre>{{ fields | json }}</pre>-->

		<div class="row" ng-if="hasField( 'legal_entity.first_name' ) || hasField( 'legal_entity.last_name' )">
			<div class="col-sm-6">
				<form-group
					ng-if="hasField( 'legal_entity.first_name' )"
					name="legal_entity.first_name"
					label="First Name"
					>
					<input form-control>
					<control-errors></control-errors>
				</form-group>
			</div>
			<div class="col-sm-6">
				<form-group
					ng-if="hasField( 'legal_entity.last_name' )"
					name="legal_entity.last_name"
					label="Last Name"
					>
					<input form-control >
					<control-errors></control-errors>
				</form-group>
			</div>
		</div>

		<div class="row" ng-if="hasField( 'legal_entity.dob.day' ) || hasField( 'legal_entity.dob.month' ) || hasField( 'legal_entity.dob.year' ) ">
			<div class="col-sm-4">
				<form-group
					ng-if="hasField( 'legal_entity.dob.day' )"
					name="legal_entity.dob.day"
					label="Birthday"
					>
					<input form-control>
					<control-errors></control-errors>
				</form-group>
			</div>
			<div class="col-sm-4">
				<form-group
					ng-if="hasField( 'legal_entity.dob.month' )"
					name="legal_entity.dob.month"
					label="Month"
					>
					<input form-control>
					<control-errors></control-errors>
				</form-group>
			</div>
			<div class="col-sm-4">
				<form-group
					ng-if="hasField( 'legal_entity.dob.year' )"
					name="legal_entity.dob.year"
					label="Year"
					>
					<input form-control >
					<control-errors></control-errors>
				</form-group>
			</div>
		</div>

		<div ng-if="account.type == 'individual'">
			<form-group
				ng-if="hasField( 'legal_entity.address.line1' )"
				name="legal_entity.address.line1"
				label="Address"
				>
				<input form-control >
				<control-errors></control-errors>
			</form-group>

			<div class="row" ng-if="hasField( 'legal_entity.address.city' )">
				<div class="col-sm-4">
					<form-group
						ng-if="hasField( 'legal_entity.address.city' )"
						name="legal_entity.address.city"
						label="City"
						>
						<input form-control>
						<control-errors></control-errors>
					</form-group>
				</div>
				<div class="col-sm-4">
					<form-group
						ng-if="hasField( 'legal_entity.address.state' )"
						name="legal_entity.address.state"
						label="State"
						>
						<input form-control>
						<control-errors></control-errors>
					</form-group>
				</div>
				<div class="col-sm-4">
					<form-group
						ng-if="hasField( 'legal_entity.address.postal_code' )"
						name="legal_entity.address.postal_code"
						label="Zip Code"
						>
						<input form-control>
						<control-errors></control-errors>
					</form-group>
				</div>
			</div>



		</div>

		<div ng-if="account.type=='company'">
			<form-group
				ng-if="hasField( 'legal_entity.personal_address.line1' )"
				name="legal_entity.personal_address.line1"
				label="Address"
				>
				<input form-control >
				<control-errors></control-errors>
			</form-group>

			<div class="row" ng-if="hasField( 'legal_entity.personal_address.city' )">
				<div class="col-sm-4">
					<form-group
						ng-if="hasField( 'legal_entity.personal_address.city' )"
						name="legal_entity.personal_address.city"
						label="City"
						>
						<input form-control>
						<control-errors></control-errors>
					</form-group>
				</div>
				<div class="col-sm-4">
					<form-group
						ng-if="hasField( 'legal_entity.personal_address.state' )"
						name="legal_entity.personal_address.state"
						label="State"
						>
						<input form-control>
						<control-errors></control-errors>
					</form-group>
				</div>
				<div class="col-sm-4">
					<form-group
						ng-if="hasField( 'legal_entity.personal_address.postal_code' )"
						name="legal_entity.personal_address.postal_code"
						label="Zip Code"
						>
						<input form-control>
						<control-errors></control-errors>
					</form-group>
				</div>
			</div>


			<form-group name="verification_document_0" label="Personal ID Document">
				<p class="help-block">This should be a scan of passport, driving licence, or other government supplied identification.</p>
				<!-- gj-max-filesize="maxFilesize"
					gj-max-img-width="maxWidth"
					gj-max-img-height="maxHeight" -->
				<gj-form-upload-control
					form-control="upload"
					accept=".png,.jpg,.jpeg,.gif"
					>
				</gj-form-upload-control>
				<control-errors ></control-errors>
			</form-group>


		</div>

		<div class="row" ng-if="hasField( 'legal_entity.personal_id_number' )">
			<div class="col-sm-6">
				<form-group
					name="legal_entity.personal_id_number"
					label="Social Security Number"
					>
					<input form-control>
					<control-errors></control-errors>
				</form-group>
			</div>
		</div>

	</fieldset>

	<fieldset ng-if="account.type=='company'">
		<legend>Your Company</legend>

		<div class="row">
			<div class="col-sm-6">
				<form-group
					ng-if="hasField( 'legal_entity.business_name' )"
					name="legal_entity.business_name"
					label="Company Name"
					>
					<input form-control>
					<control-errors></control-errors>
				</form-group>
			</div>
			<div class="col-sm-6">
				<form-group
					ng-if="hasField( 'legal_entity.business_tax_id' )"
					name="legal_entity.business_tax_id"
					label="Company Tax Id"
					>
					<input form-control>
					<control-errors></control-errors>
				</form-group>
			</div>
		</div>

		<form-group
			ng-if="hasField( 'legal_entity.address.line1' )"
			name="legal_entity.address.line1"
			label="Address"
			>
			<input form-control >
			<control-errors></control-errors>
		</form-group>

		<div class="row" ng-if="hasField( 'legal_entity.address.city' )">
			<div class="col-sm-4">
				<form-group
					ng-if="hasField( 'legal_entity.address.city' )"
					name="legal_entity.address.city"
					label="City"
					>
					<input form-control>
					<control-errors></control-errors>
				</form-group>
			</div>
			<div class="col-sm-4">
				<form-group
					ng-if="hasField( 'legal_entity.address.state' )"
					name="legal_entity.address.state"
					label="State"
					>
					<input form-control>
					<control-errors></control-errors>
				</form-group>
			</div>
			<div class="col-sm-4">
				<form-group
					ng-if="hasField( 'legal_entity.address.postal_code' )"
					name="legal_entity.address.postal_code"
					label="Zip Code"
					>
					<input form-control>
					<control-errors></control-errors>
				</form-group>
			</div>
		</div>

	</fieldset>

	<fieldset ng-if="account.type=='company'">
		<legend>Additional Owners</legend>
		<p class="small">The law in your jurisdiction dictates we have to collect information on any company shareholders with a 25% share or more. </p>

		<!-- Foreach additional owner -->
		<div ng-repeat="(key,value) in formModel['legal_entity.additional_owners']">
			<legend>{{ value.first_name }} {{ value.last_name }}</legend>
				
			<div class="row">
				<div class="col-sm-6">
					<form-group
						name="legal_entity.additional_owners.{{key}}.first_name"
						label="First Name"
						>
						<input form-control ng-model="value.first_name">
						<control-errors></control-errors>
					</form-group>
				</div>
				<div class="col-sm-6">
					<form-group
						name="legal_entity.additional_owners.{{key}}.last_name"
						label="Last Name"
						>
						<input form-control ng-model="value.last_name">
						<control-errors></control-errors>
					</form-group>
				</div>
			</div>

			<div class="row" >
				<div class="col-sm-4">
					<form-group
						name="legal_entity.additional_owners.{{key}}.dob.day"
						label="Birthday"
						>
						<input form-control ng-model="value.dob.day">
						<control-errors></control-errors>
					</form-group>
				</div>
				<div class="col-sm-4">
					<form-group
						name="legal_entity.additional_owners.{{key}}.dob.month"
						label="Month"
						>
						<input form-control ng-model="value.dob.month">
						<control-errors></control-errors>
					</form-group>
				</div>
				<div class="col-sm-4">
					<form-group
						name="legal_entity.additional_owners.{{key}}.dob.year"
						label="Year"
						>
						<input form-control ng-model="value.dob.year">
						<control-errors></control-errors>
					</form-group>
				</div>
			</div>

			<form-group
				name="legal_entity.additional_owners.{{key}}.address.line1"
				label="Address"
				>
				<input form-control ng-model="value.address.line1">
				<control-errors></control-errors>
			</form-group>

			<div class="row">
				<div class="col-sm-4">
					<form-group
						name="legal_entity.additional_owners.{{key}}.address.city"
						label="City"
						>
						<input form-control ng-model="value.address.city">
						<control-errors></control-errors>
					</form-group>
				</div>
				<div class="col-sm-4">
					<form-group
						name="legal_entity.additional_owners.{{key}}.address.state"
						label="State"
						>
						<input form-control ng-model="value.address.state">
						<control-errors></control-errors>
					</form-group>
				</div>
				<div class="col-sm-4">
					<form-group
						name="legal_entity.additional_owners.{{key}}.address.postal_code"
						label="Zip Code"
						>
						<input form-control ng-model="value.address.postal_code">
						<control-errors></control-errors>
					</form-group>
				</div>
			</div>



		</div>

		<div class="row">
			<div class="col-sm-12">
				<button class="btn" ng-click="addAdditionalOwner()">
					<span class="jolticon jolticon-chevron-right"></span>
					Add
				</button>
			</div>
		</div>

	</fieldset>


	<fieldset ng-if="account">
		<legend>Percentage Split</legend>

		<p class="small">You're able to decide how much you think we deserve from your sales. <strong>We won't allow you to give us more than 10%.</strong></p>
		<p class="small">If you feel like supporting Game Jolt, we'd rather you spend your revenue on buying games from other developers. We have a Wallet system to help in this!</p>

		<div class="form-group">
			<rzslider
				rz-slider-model="formModel.percentage_split"
				rz-slider-options="sliderOptions"
				>
			</rzslider>
		</div>

	</fieldset>

	<fieldset ng-if="account">
		<legend>Wallet</legend>

		<p class="small">We store up to a certain amount of money in your Wallet. You can use this money to buy other games on the site from other developers. Money goes directly to them when using Wallet funds. We never take a cut for game sales when you pay with your Wallet.</p>

		 <form-group
			name="wallet_maximum"
			label="Max. Wallet Amount"
			>
			<p class="help-block">
				You can store up to $300 USD in your Wallet. <br>
				You can turn off the Wallet by setting it to $0.
			</p>

			<input-group>
				<input-group-addon>
					$
				</input-group-addon>
				<input form-control="number" ng-max="300">
			</input-group>
			<control-errors></control-errors>
		</form-group>

	</fieldset>


	<fieldset ng-if="account">
		<legend>Minimum Payout</legend>

		<p class="small">Lorem ipsum.</p>

		 <form-group
			name="payout_minimum"
			label="Min. Payout Amount"
			>
			<p class="help-block">
				HELP<br>HELP
			</p>

			<input-group>
				<input-group-addon>
					$
				</input-group-addon>
				<input form-control="number" ng-min="0">
			</input-group>
			<control-errors></control-errors>
		</form-group>

	</fieldset>

	<p>By registering your account, you agree to our <a href='#' target='new'>Terms of Service</a> and the <a href='https://stripe.com/connect/account-terms' target='new'>Stripe Connected Account Agreement</a>.</p>

	<button
		gj-form-submit-button class="btn"
		ng-disabled="!financialsForm.$valid"
		ng-click="onSubmit()"
		>
		<span class="jolticon jolticon-checkbox"></span>
		Save
	</button>

</form>
