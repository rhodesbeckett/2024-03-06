<!-- Buttons -->
<div class="devlog-post-controls">
	<hr>

	<div class="devlog-post-controls-links">
		<a class="link-muted"
			ng-click="$ctrl.toggleComments()"
			ng-switch="$ctrl.post.comment_count > 0"
			>
			<span
				ng-switch-when="true"
				translate
				translate-n="$ctrl.post.comment_count"
				translate-plural="{{ $count | number }} comments"
				>
				1 comment
			</span>
			<span
				ng-switch-when="false"
				translate
				>
				Leave a comment
			</span>
		</a>

		<span ng-if="$ctrl.post.like_count > 0">
			<span class="dot-separator"></span>
			<a class="link-muted"
				ng-click="$ctrl.toggleLikes()"
				translate
				translate-n="$ctrl.post.like_count"
				translate-plural="{{ $count | number }} likes"
				>
				1 like
			</a>
		</span>

		<span ng-if="::$ctrl.feed.showGameInfo">
			<span class="dot-separator"></span>
			<a class="link-muted"
				ui-sref="discover.games.view.overview( { slug: $ctrl.post.game.slug, id: $ctrl.post.game.id } )"
				translate
				>
				View game
			</a>
		</span>

		<span class="dot-separator hidden-xs"></span>
		<br class="visible-xs">
		<br class="visible-xs">

		<a class="link-muted" gj-popover-trigger="activity-feed-devlog-post-share-{{ ::$ctrl.post.id }}">
			<span class="jolticon jolticon-share"></span>
			<span translate>Share</span>
		</a>

		<gj-popover
			class="popover-dark"
			popover-id="activity-feed-devlog-post-share-{{ ::$ctrl.post.id }}"
			popover-append-to-body="true"
			popover-on-focus="$ctrl.isShowingShare = true"
			popover-on-blur="$ctrl.isShowingShare = false"
			>

			<div class="well sans-margin">
				<div class="social-widgets"
					ng-if="$ctrl.isShowingShare"
					>
					<gj-social-twitter-share
						url="{{ ::$ctrl.shareUrl }}"
						content="{{ ::$ctrl.post.title }}"
						>
					</gj-social-twitter-share>
					<span class="dot-separator"></span>
					<gj-social-facebook-like
						url="{{ ::$ctrl.shareUrl }}"
						>
					</gj-social-facebook-like>
				</div>

				<button class="btn btn-outline btn-block"
					ng-click="$ctrl.copyShareUrl()"
					translate
					>
					Copy Permalink
				</button>
			</div>

		</gj-popover>

		<div class="devlog-post-controls-stats"
			ng-if="::$ctrl.app.user && $ctrl.post.user.id == $ctrl.app.user.id"
			>

			<span
				translate
				translate-n="$ctrl.post.view_count || 0"
				translate-plural="{{ $count | number }} views"
				>
				1 view
			</span>

			<span class="dot-separator"></span>

			<span
				translate
				translate-n="$ctrl.post.expand_count || 0"
				translate-plural="{{ $count | number }} expands"
				>
				1 expand
			</span>

			<span tooltip="{{ ::'An expand is some sort of interaction with your post. For example, playing a video post, or clicking into your post.' | translate }}">
				<span class="jolticon jolticon-help-circle"></span>
			</span>

		</div>
	</div>

	<div class="clearfix">
		<div class="pull-left" ng-if="::$ctrl.post.status == $ctrl.firesidePostModel.STATUS_ACTIVE">
			<button class="btn btn-outline btn-sparse"
				ng-if="::$ctrl.feed"
				ng-click="$ctrl.toggleComments()"
				gj-tooltip="Comment on This Post"
				>
				<span class="jolticon jolticon-reply"></span>
			</button>

			<gj-fireside-post-like-widget
				fireside-post="$ctrl.post"
				sparse="true"
				>
			</gj-fireside-post-like-widget>
		</div>

		<div class="pull-right">
			<gj-game-follow-widget
				ng-if="::$ctrl.feed && $ctrl.feed.showGameInfo && $ctrl.app.user && $ctrl.post.user.id != $ctrl.app.user.id"
				game="::$ctrl.post.game"
				>
			</gj-game-follow-widget>

			<div ng-if="::$ctrl.feed && $ctrl.feed.showEditControls && $ctrl.app.user && $ctrl.post.user.id == $ctrl.app.user.id">
				<button class="btn btn-success-outline" ng-if="::$ctrl.post.status == $ctrl.firesidePostModel.STATUS_DRAFT" ng-click="$ctrl.publishPost()">
					<span class="jolticon jolticon-check"></span>
					<span translate>Publish</span>
				</button>
				<button class="btn btn-outline" ng-click="$ctrl.showEdit()">
					<span class="jolticon jolticon-edit"></span>
					<span translate>Edit</span>
				</button>
				<button class="btn btn-outline btn-sparse" gj-popover-trigger="devlog-post-controls-options-{{ ::$ctrl.post.id }}">
					<span class="jolticon jolticon-ellipsis-h"></span>
				</button>
			</div>
		</div>
	</div>

</div>

<div ng-if="::$ctrl.feed">
	<gj-popover popover-id="devlog-post-controls-options-{{ ::$ctrl.post.id }}">
		<div class="list-group list-group-dark">
			<a class="list-group-item has-icon"
				ng-click="$ctrl.removePost()"
				>
				<span class="jolticon jolticon-remove warning"></span>
				<span translate>Remove Post</span>
			</a>
		</div>
	</gj-popover>

	<div class="devlog-post-controls-well" ng-if="$ctrl.isShowingComments">
		<gj-comment-widget
			comment-resource="Fireside_Post"
			comment-resource-id="::$ctrl.post.id"
			no-intro="true"
			on-comment-count="$ctrl.post.comment_count = $count"
			>
		</gj-comment-widget>
	</div>
</div>

<div class="devlog-post-controls-well" ng-if="$ctrl.isShowingLikes">

	<gj-loading ng-if="!$ctrl.hasLoadedLikes"></gj-loading>

	<div ng-if="$ctrl.hasLoadedLikes">
		<a
			ng-repeat="like in $ctrl.likes track by like.id"
			ui-sref="profile.overview( { slug: like.user.slug, id: like.user.id } )"
			>
			<gj-card>
				<div style="width: 40px; height: 40px; float: left">
					<div class="friend-request-popover-avatar" gj-user-avatar="::like.user"></div>
				</div>
				<div style="margin-left: 55px;">
					<div class="card-title">
						<h5>{{ ::like.user.display_name }}</h5>
					</div>
				</div>
			</gj-card>
		</a>
	</div>

</div>
