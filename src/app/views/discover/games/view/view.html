<div class="route-discover-games-view"
	v-if="game"
	>

	<app-game-maturity-block :game="game">

		<section class="section section-thin fill-darkest"
			v-if="app.user && app.user.id === game.developer.id"
			>
			<div class="container text-center">

				<router-link
					class="btn btn-outline hidden-xs"
					:to="{
						name: 'dash.analytics',
						params: { resource: 'Game', resourceId: game.id },
					}"
					>
					<app-jolticon icon="chart" />
					<translate>View Analytics</translate>
				</router-link>

				<router-link
					class="btn btn-outline"
					:to="{
						name: 'dash.games.manage.game.overview',
						params: { id: game.id },
					}"
					>
					<app-jolticon icon="cog" />
					<translate>Manage Game</translate>
				</router-link>

			</div>
		</section>

		<!--
			Don't affix the nav on download pages.
			It takes a lot of space out vertically when on small browser size.
		-->
		<app-page-header
			:cover-media-item="game.header_media_item"
			:should-affix-nav="$route.name !== 'discover.games.view.download'"
			:autoscroll-anchor-key="game.id"
			>

			<!--
				Only show the cover buttons on the overview page.
			-->
			<div slot="cover-buttons">
				<app-game-cover-buttons
					v-if="
						!Screen.isXs
						&& $route.name === 'discover.games.view.overview'
					"
					:game="game"
					:packages="packages"
					:installable-builds="installableBuilds"
					:browser-builds="browserBuilds"
					:partner-key="partnerKey"
					:partner="partner"
					@multiple="scrollToMultiplePackages"
					/>
			</div>

			<app-user-avatar
				slot="spotlight"
				:user="game.developer"
				/>

			<app-discover-games-view-nav
				slot="nav"
				/>

			<app-discover-games-view-controls
				slot="controls"
				/>

			<h1 :class="{ h2: Screen.isMobile }">
				<router-link :to="{ name: 'discover.games.view.overview' }">
					{{ game.title }}
				</router-link>
			</h1>

			<div>
				<translate>by</translate>
				<router-link :to="{ name: 'profile.overview', params: { username: game.developer.username } }">
					{{ game.developer.display_name }}
					<small>@{{ game.developer.username }}</small>
				</router-link>

				<!--
					Hide on mobile to keep it clean.
					They can view in the game details.
				-->
				<span class="small" v-if="!Screen.isXs && game.published_on">
					<span class="dot-separator"></span>
					<router-link
						:to="{
							name: 'discover.games.list._fetch-date',
							params: {
								section: 'by-date',
								date: date( game.published_on, 'YYYY-MM-DD' ),
							},
						}"
						>
						<app-time-ago :date="game.published_on" />
					</router-link>
				</span>

				<span v-if="game.tigrs_age || game.ratings_enabled">
					<span class="dot-separator hidden-xs"></span>
					<br class="visible-xs">
					<br class="visible-xs">

					<app-game-ogrs-tag
						v-if="game.tigrs_age"
						:game="game"
						/>

					<span v-if="!game._is_devlog && game.ratings_enabled">
						<span class="dot-separator"></span>
						<app-meter
							:big="true"
							:dark="true"
							:rating="game.avg_rating"
							v-app-tooltip="ratingTooltip"
							/>
					</span>
				</span>
			</div>

		</app-page-header>

		<router-view />

	</app-game-maturity-block>
</div>
