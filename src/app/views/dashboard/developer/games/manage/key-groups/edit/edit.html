<div class="row">
	<div class="col-sm-10 col-md-7 col-lg-6">

		<h2 class="section-header">
			Edit Key Group
		</h2>
		<gj-form-dashboard-game-key-group
			game="manageCtrl.game"
			packages="editCtrl.packages"
			gj-key-group="editCtrl.keyGroup"
			gj-form-submit-handler="editCtrl.onKeyGroupSaved( formModel )"
			>
		</gj-form-dashboard-game-key-group>

	</div>
	<div class="col-sm-10 col-md-4 col-md-offset-1 col-lg-5">

		<h5><strong>Viewed</strong></h5>
		<p>34 / 50 <small>(67%)</small></p>
		<div class="progress progress-thin">
			<div class="progress-bar" style="width: 67%"></div>
		</div>

		<h5><strong>Claimed</strong></h5>
		<p>34 / 50 <small>(67%)</small></p>
		<div class="progress progress-thin">
			<div class="progress-bar" style="width: 67%"></div>
		</div>

		<hr>

		<div>
			<a class="btn btn-danger-outline btn-block" ng-click="editCtrl.removeGroup( editCtrl.keyGroup )">
				<span class="jolticon jolticon-remove"></span>
				Remove Key Group
			</a>
		</div>

	</div>
</div>

<h2 translate>
	Keys
</h2>

<div class="well fill-lightest form-inline">

	<div class="form-group">
		<input type="text" class="form-control" placeholder="Filter" ng-model="editCtrl.search.filter">
	</div>

	<div class="form-group">
		<select class="form-control" ng-model="editCtrl.search.state">
			<option value="all">All</option>
			<option value="claimed">Claimed</option>
			<option value="not-claimed">Not Claimed</option>
			<option value="viewed">Viewed</option>
			<option value="not-viewed">Not Viewed</option>
		</select>
	</div>

	<button class="btn btn-outline" ng-click="editCtrl.searchKeys()">
		Submit
	</button>

</div>

<table class="table table-hover">
	<thead>
		<tr>
			<th>Key</th>
			<th>Claimed User</th>
			<th ng-if="keyGroup.type == KeyGroup.TYPE_EMAIL">Email</th>
			<th>Claimed On</th>
			<th>Last Viewed On</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr ng-repeat="key in editCtrl.keys track by key.id">
			<td>
				<code>{{ ::key.key }}</code>
			</td>
			<td ng-switch="::!!key.user_id">
				<span ng-switch-when="true">{{ ::key.user_id }}</span>
				<span ng-switch-when="false">-</span>
			</td>
			<td ng-if="::keyGroup.type == KeyGroup.TYPE_EMAIL">
				{{ ::key.email }}
			</td>
			<td ng-switch="::!!key.claimed_on">
				<span ng-switch-when="true" am-time-ago="::key.claimed_on"></span>
				<span ng-switch-when="false">-</span>
			</td>
			<td ng-switch="::!!key.viewed_on">
				<span ng-switch-when="true" am-time-ago="::key.viewed_on"></span>
				<span ng-switch-when="false">-</span>
			</td>
			<td style="text-align: right">
				<a class="btn btn-danger-outline btn-sm btn-sparse"
					ng-click="editCtrl.removeKey( key )"
					>
					<span class="jolticon jolticon-remove"></span>
				</a>
			</td>
		</tr>
	</tbody>
</table>
